
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://shaynemei.github.io/hackore/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://shaynemei.github.io/hackore/theme/pygments/friendly.min.css">
  <link rel="stylesheet" type="text/css" href="https://shaynemei.github.io/hackore/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://shaynemei.github.io/hackore/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Hackore Atom">


    <link rel="shortcut icon" href="/hackore/img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/hackore/img/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />


<meta name="author" content="Shayne" />
<meta name="description" content="Choosing ML algorithms, evaluating and tuning model parameters." />
<meta name="keywords" content="python, machine learning">
<meta property="og:site_name" content="Hackore"/>
<meta property="og:title" content="Data Evaluation"/>
<meta property="og:description" content="Choosing ML algorithms, evaluating and tuning model parameters."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://shaynemei.github.io/hackore/data_evaluation.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-07-16 20:00:00+08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://shaynemei.github.io/hackore/author/shayne.html">
<meta property="article:section" content="Notes"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="machine learning"/>
<meta property="og:image" content="/hackore/img/profile.png">

  <title>Hackore &ndash; Data Evaluation</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://shaynemei.github.io/hackore">
        <img src="/hackore/img/profile.png" alt="Hackore" title="Hackore">
      </a>
      <h1><a href="https://shaynemei.github.io/hackore">Hackore</a></h1>

<p>Hack it till you make it.</p>
      <nav>
        <ul class="list">

          <li><a href="http://blog.yhat.com" target="_blank">Å·hat</a></li>
          <li><a href="https://chrisalbon.com/#Python" target="_blank">ChrisAlbon</a></li>
          <li><a href="https://blog.dataiku.com" target="_blank">dataiku</a></li>
          <li><a href="https://fivethirtyeight.com" target="_blank">FiveThirtyEight</a></li>
          <li><a href="http://www.nltk.org/book/" target="_blank">NLTKBook</a></li>
          <li><a href="https://www.edx.org" target="_blank">edX</a></li>
          <li><a href="http://coursera.org/" target="_blank">Coursera</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/shayne-mei-006858aa/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/shaynemei" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-facebook" href="https://facebook.com/shaynemei" target="_blank"><i class="fa fa-facebook"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://shaynemei.github.io/hackore">    Home
</a>

      <a href="https://shaynemei.github.io/hackore/archives.html">Archives</a>
      <a href="https://shaynemei.github.io/hackore/categories.html">Categories</a>
      <a href="https://shaynemei.github.io/hackore/tags.html">Tags</a>

      <a href="https://shaynemei.github.io/hackore/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
    <h1 id="data_evaluation">Data Evaluation</h1>
    <p>
          Posted on Jul 16, 2018 in <a href="https://shaynemei.github.io/hackore/category/notes.html">Notes</a>


        &#8226; 15 min read
    </p>
  </header>


  <div>
    <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Choosing-ML-Algorithms">Choosing ML Algorithms<a class="anchor-link" href="#Choosing-ML-Algorithms">Â¶</a></h1><ul>
<li>The dimensionality of your data</li>
<li>The geometric nature of your data</li>
<li>The types of features used to represent your data</li>
<li>The number of training samples you have at your disposal</li>
<li>The required training and prediction speeds needed for your purposes</li>
<li>The predictive accuracy level desired</li>
<li>How configurable you need your model to be</li>
</ul>
<h2 id="Scikit-learn">Scikit learn<a class="anchor-link" href="#Scikit-learn">Â¶</a></h2><p><a href="http://scikit-learn.org/stable/tutorial/machine_learning_map/index.html">Scikit-learn ML Cheat Sheet</a></p>
<p><img alt="title" src="img/sklearnML_cheatsheet.png"/></p>
<h2 id="Microsoft-Azure">Microsoft Azure<a class="anchor-link" href="#Microsoft-Azure">Â¶</a></h2><p><a href="https://docs.microsoft.com/en-us/azure/machine-learning/studio/algorithm-choice">Microsoft Azure ML Algorithm Cheat Sheet Article</a></p>
<p><img alt="title" src="img/azureML_cheatsheet.png"/></p>
<h1 id="Evaluating-Algorithm-Performance">Evaluating Algorithm Performance<a class="anchor-link" href="#Evaluating-Algorithm-Performance">Â¶</a></h1><h2 id="Confusion-Matrix">Confusion Matrix<a class="anchor-link" href="#Confusion-Matrix">Â¶</a></h2><p>A confusion matrix displays your model's predicted (testing set) outputs against the true observational values.<br/>
Traditionally, the predicted targets are aligned on the X-axis of the matrix, and the true values are aligned on the Y-axis.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sklearn.metrics</span> <span class="k">as</span> <span class="nn">metrics</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># Actual, observed testing dataset values</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># Values predicted </span>
<span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([[2, 0, 0],
       [1, 0, 1],
       [0, 1, 1]])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="title" src="img/confusion_table.png"/></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Diagonals from the top left to the bottom right: correctly classified labels<br/>
Sum up the values in a row: true count of data<br/>
Sum up the values in a column: predicted count of model</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Visulisation of the confusion matrix</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Cat'</span><span class="p">,</span> <span class="s1">'Dog'</span><span class="p">,</span> <span class="s1">'Monkey'</span><span class="p">]</span>
<span class="n">confusion</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">confusion</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">columns</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">'vertical'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">columns</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Scoring-Metric">Scoring Metric<a class="anchor-link" href="#Scoring-Metric">Â¶</a></h2><ul>
<li>Condition Positive (P): Actual positive samples</li>
<li>Condition Negative (N): Actual negative samples</li>
<li>True Positive (TP/hit): Positives correctly predicted</li>
<li>True Negative (TN): Negatives correctly predicted</li>
<li>False Postive (FP/false alarm): Negatives predicted as positives</li>
<li>Fales Negative (FN/miss): Positives predicted as negatives  </li>
</ul>
<ol>
<li>True Positive Rate/Sensitivity/Model Recall/Hit Rate: <strong>TP/P</strong></li>
<li>True Negative Rate/Specificity: <strong>TN/N</strong></li>
<li>Recall Score: <strong>TP/(TP+FN)</strong></li>
<li>Precision: <strong>TP/(TP+FP)</strong></li>
<li>F1 Score: <strong>2 * (Precision * Recall) / (Precision + Recall)</strong> </li>
<li>Positive Predictive Value/Precision: <strong>TP/(TN+FP)</strong></li>
<li>Negative Predictive Value: <strong>TN/(TN+FP)</strong></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Same as `model.score()`</span>
<span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Recall Score</span>
<span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'weighted'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Precision Score</span>
<span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'weighted'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[11]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0.38888888888888884</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># F1 Score</span>
<span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'weighted'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[12]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0.43333333333333335</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Full Report on a per label basis</span>
<span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Cat'</span><span class="p">,</span> <span class="s1">'Dog'</span><span class="p">,</span> <span class="s1">'Monkey'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">))</span> <span class="c1"># Must be printed for formmated result</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>             precision    recall  f1-score   support

        Cat       0.67      1.00      0.80         2
        Dog       0.00      0.00      0.00         2
     Monkey       0.50      0.50      0.50         2

avg / total       0.39      0.50      0.43         6

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cross-Validation">Cross Validation<a class="anchor-link" href="#Cross-Validation">Â¶</a></h2><p>Cross validation allows you to use the same training data to both fit and score your model without the need for an additional validation set.<br/>
It allows you to use all the data you provide as both training and testing.<br/>
It simplifies the overall process.</p>
<h3 id="Problems-with-train_test_split()">Problems with <code>train_test_split()</code><a class="anchor-link" href="#Problems-with-train_test_split()">Â¶</a></h3><ul>
<li>Without a deterministic selection of training data and testing data, you might train using the best subset of data but test on outliers, or some permutation in-between.</li>
<li>By withholding data from training, you essentially lose some of your training data.</li>
<li>Some information of testing set leaked into your training set during iterations over the configurable parameters.</li>
</ul>
<h3 id="cross_val_score()"><code>cross_val_score()</code><a class="anchor-link" href="#cross_val_score()">Â¶</a></h3><ol>
<li>input: model, training set, 'K' (K-fold cross validations)</li>
<li>training set cut into 'K' sets</li>
<li>model duplicated into 'K' versions</li>
<li>each version of the model trained with 'K-1' sets of training data</li>
<li>each version of the model evaluated with the out-of-bag set </li>
</ol>
<h3 id="cv-parameter"><code>cv</code> parameter<a class="anchor-link" href="#cv-parameter">Â¶</a></h3><ul>
<li>(None) uses the default 3-fold cross validation</li>
<li>(int) number of folds in a (Stratified)K-Fold</li>
<li>(str) an object to be used as a cross-validation generator<ol>
<li>Leave-One-Out: ideally each having all samples except one.</li>
<li>K-Fold: ideally of equal size.</li>
<li>Stratified K-Fold: ideally each group having the same proportion of target classes.</li>
<li>Label K-Fold: ideally the same target never appearing in both testing and training groups simultaneously.  </li>
</ol>
</li>
</ul>
<p><strong>if the estimator is a classifier and y is either binary or multiclass, StratifiedKFold is used. In all other cases, KFold is used.</strong><br/>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html#sklearn.model_selection.cross_val_score">DOCUMENTATION</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 10-Fold Cross Validation on your training data   </span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">cross_val_score</span>   
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>   <span class="c1"># returns an array of cval scores for each version of the model</span>
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>   <span class="c1"># return the mean score of all versions of the model</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Process">Process<a class="anchor-link" href="#Process">Â¶</a></h3><ol>
<li>Split your data into training, validation, and testing sets.</li>
<li>Setup a model, and fit it with your training set</li>
<li>Access the accuracy of its output using your validation set</li>
<li>Fine tune this accuracy by adjusting the hyper-parameters of your model</li>
<li>when you're comfortable with its accuracy, finally evaluate your model with the testing set</li>
</ol>
<h4 id="OR">OR<a class="anchor-link" href="#OR">Â¶</a></h4><ol>
<li>Split your data into training and testing sets.</li>
<li>Setup a model with cross validation and fit / score it with your training set</li>
<li>Fine tune this accuracy by adjusting the hyper-parameters of your model</li>
<li>When you're comfortable with its accuracy, finally evaluate your model with the testing set</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Power-Tuning">Power Tuning<a class="anchor-link" href="#Power-Tuning">Â¶</a></h2><h3 id="GridSearchCV"><code>GridSearchCV</code><a class="anchor-link" href="#GridSearchCV">Â¶</a></h3><p>Scikit-learn's systematic way of tuning parameters with end-to-end cross validation.<br/>
Explicitly define the parameters you want tested.<br/>
Pass in an estimator, a grid of parameters you want optimized, and your cv split value.</p>
<p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">DOCUMENTATION</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">svm</span><span class="p">,</span> <span class="n">grid_search</span><span class="p">,</span> <span class="n">datasets</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>   
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'kernel'</span><span class="p">:(</span><span class="s1">'linear'</span><span class="p">,</span> <span class="s1">'rbf'</span><span class="p">),</span> <span class="s1">'C'</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>   
<span class="n">model</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span> 
<span class="n">classifier</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>   
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>    
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[17]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>GridSearchCV(cv=None, error_score='raise',
       estimator=SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=False, random_state=None, shrinking=True,
  tol=0.001, verbose=False),
       fit_params={}, iid=True, n_jobs=1,
       param_grid={'kernel': ('linear', 'rbf'), 'C': [1, 5, 10]},
       pre_dispatch='2*n_jobs', refit=True, scoring=None, verbose=0)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="RandomizedSearchCV"><code>RandomizedSearchCV</code><a class="anchor-link" href="#RandomizedSearchCV">Â¶</a></h3><p>Randomized parameter optimization.<br/>
Pass in your parameters as a single dictionary that holds either possible, discrete parameter values or distribution over them.<br/>
<a href="https://docs.scipy.org/doc/scipy/reference/stats.html">SciPy's Statistics module</a> have many such functions you can use to create continuous, discrete, and multivariate type distributions, such as <code>expon</code>, <code>gamma</code>, <code>uniform</code>, <code>randint</code> and many more</p>
<p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html">DOCUMENTATION</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create dictionary of distributions of parameters</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>

<span class="n">parameter_dist</span> <span class="o">=</span> <span class="p">{</span>  
  <span class="s1">'C'</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>   
  <span class="s1">'kernel'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'linear'</span><span class="p">],</span>   
  <span class="s1">'gamma'</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="p">(</span><span class="n">scale</span><span class="o">=.</span><span class="mi">1</span><span class="p">),</span>   
<span class="p">}</span>   

<span class="n">classifier</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">RandomizedSearchCV</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">parameter_dist</span><span class="p">)</span>   
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[19]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>RandomizedSearchCV(cv=None, error_score='raise',
          estimator=SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma='auto', kernel='rbf',
  max_iter=-1, probability=False, random_state=None, shrinking=True,
  tol=0.001, verbose=False),
          fit_params={}, iid=True, n_iter=10, n_jobs=1,
          param_distributions={'C': &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x11692e128&gt;, 'kernel': ['linear'], 'gamma': &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x11692e278&gt;},
          pre_dispatch='2*n_jobs', random_state=None, refit=True,
          scoring=None, verbose=0)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pipelining">Pipelining<a class="anchor-link" href="#Pipelining">Â¶</a></h2><p>A Scikit-learn class that wraps around your entire data analysis pipeline from start to finish, and allows you to interact with the pipeline as if it were a single white-box, configurable estimator. Cnce your pipeline has been built, since the pipeline inherits from the estimator base class, you can use it pretty much anywhere you'd use regular estimatorsâincluding in your cross validator method. Doing so, you can simultaneously fine tune the parameters of each of the estimators and predictors that comprise your data-analysis pipeline.</p>
<p><strong>Usage</strong></p>
<ul>
<li>Every intermediary model within the pipeline must be a transformer, i.e. its class must implement both the <code>.fit()</code> and the <code>.transform()</code> methods.</li>
<li>The very last step in your analysis pipeline only needs to implement the <code>.fit()</code> method, since it will not be feeding data into another step.</li>
<li>Two underscores after estimator names and before parameters</li>
<li>The pipeline class only has a single attribute called <code>.named_steps</code>, which is a dictionary containing the estimator names you specified as keys. </li>
</ul>
<p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html">DOCUMENTATION</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Pipeline example</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="k">import</span> <span class="n">RandomizedPCA</span>

<span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">)</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">RandomizedPCA</span><span class="p">()</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
  <span class="p">(</span><span class="s1">'pca'</span><span class="p">,</span> <span class="n">pca</span><span class="p">),</span>
  <span class="p">(</span><span class="s1">'svc'</span><span class="p">,</span> <span class="n">svc</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">pipeline</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">pca__n_components</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">svc__C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">svc__gamma</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/anaconda3/lib/python3.6/site-packages/sklearn/utils/deprecation.py:58: DeprecationWarning: Class RandomizedPCA is deprecated; RandomizedPCA was deprecated in 0.18 and will be removed in 0.20. Use PCA(svd_solver='randomized') instead. The new implementation DOES NOT store whiten ``components_``. Apply transform to get them.
  warnings.warn(msg, category=DeprecationWarning)
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[25]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Pipeline(memory=None,
     steps=[('pca', RandomizedPCA(copy=True, iterated_power=2, n_components=5, random_state=None,
       whiten=False)), ('svc', SVC(C=1, cache_size=200, class_weight=None, coef0=0.0,
  decision_function_shape='ovr', degree=3, gamma=0.0001, kernel='linear',
  max_iter=-1, probability=False, random_state=None, shrinking=True,
  tol=0.001, verbose=False))])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>IMPORTANT</strong>: 
Many of the predictors don't actually implement <code>.transform()</code>! Due to this, by default, you won't be able to use SVC, Linear Regression, or Decision Trees, etc. as intermediary steps within your pipeline. A very nifty hack you should be aware of to circumvent this is by writing your own transformer class, which simply wraps a predictor and masks it as a transformer:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="k">import</span> <span class="n">TransformerMixin</span>

<span class="k">class</span> <span class="nc">ModelTransformer</span><span class="p">(</span><span class="n">TransformerMixin</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">transform_params</span><span class="p">):</span>
        <span class="c1"># This is the magic =)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://shaynemei.github.io/hackore/tag/python.html">python</a>
      <a href="https://shaynemei.github.io/hackore/tag/machine-learning.html">machine learning</a>
    </p>
  </div>


  <div class="related-posts">
    <h4>    You might enjoy
</h4>
    <ul class="related-posts">
      <li><a href="https://shaynemei.github.io/hackore/preprocessing.html">Preprocessing - Feature Scaling</a></li>
      <li><a href="https://shaynemei.github.io/hackore/data_visualisation.html">Data Visualisation</a></li>
      <li><a href="https://shaynemei.github.io/hackore/classification_svc.html">SVC</a></li>
      <li><a href="https://shaynemei.github.io/hackore/isomap.html">Isomap Dimensionality Reduction</a></li>
      <li><a href="https://shaynemei.github.io/hackore/classification_kn.html">K-Neighbors Classification</a></li>
    </ul>
  </div>


<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'Hackore';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>&copy; Shayne Mei </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-122471984-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->



<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Hackore ",
  "url" : "https://shaynemei.github.io/hackore",
  "image": "/hackore/img/profile.png",
  "description": "A blog written for the lonely and brave exploring the vast world of computer science."
}
</script>
</body>
</html>